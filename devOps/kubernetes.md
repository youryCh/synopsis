Всю инфу о переменных, используемых внутри контейнера, можно посмотреть в Workloads/Pods/Containers.
___

**Kubernetes** - опенсорсное ПО Google для автоматизации деплоя, масштабирования, управления контейнерами (оркестрация).

**Кластер** - набор машин (node), которые запускают контейнеризированное приложение; кластер имеет минимум одну  
рабочую ноду.

`kubectl` - cli инструмент для работы с кубером.

**k8s делает:**
- запуск/управление контейнерами
- балансирует сетевой трафик между узлами кластера/репликами
- контроль, авто деплой, откаты внутри узлов кластера
- предоставляет api, cli для управления

**k8s не делает:**
- не собирает контейнеры
- не предоставляет CI
- не собирает метрики
- не хранит контейнеры

По сути **кластер k8s состоит** из нод (Nodes, Worker Nodes). В нодах размещаются контейнеры проектов, сервисов и  
самого кластера.

**Worker nodes состоит:**
- kubelet - сервис/агент, который контролирует запуск контейнеров кластера
- kube-proxy - настраивает правила сети для нод

**Master nodes** - (плоскость управления) управляет рабочими нодами и подами в кластере; содержит компоненты,  
которые управляют нодами кластера и предоставляют доступ к API.

**Control plane состоит из компонентов:**
- kube-apiserver - предоставляет доступ к api k8s
- etcd - key-value хранилище для всех данных кластера; находится внутри мастера или как отдельный кластер
- kube-scheduler - планирует размещение подов на нодах кластера
- kube-control-manager - запускает контроллеры
- kubelet
___

## Виды контроллеров

**Deployments** - управляет состоянием развёртывания подов, которое описывается в манифесте; следит за созданием,  
удалением экземпляров подов; управляет контроллерами ReplicaSet.

**ReplicaSet** - гарантирует что определённое количество экземпляров подов всегда будет запущено в кластере.

**StatefulSets** - как Deployments, но сохраняет набор идентификаторов и состояние для каждого пода.

**DaemonSet** - гарантирует что на каждой ноде кластера будет экземпляр пода.

**Jobs** - создаёт поды, следит пока они успешно не завершат работу; если под завершится с ошибкой, повторяет  
создание; если под успешно отработал, записывает в журнал.

**CronJob** - запускает контроллеры Jobs по расписанию.
___

**Pods** - абстрактный объект в кластере кубера; состоит из одного/нескольких контейнеров с общим хранилищем и  
сетевыми ресурсами и спецификации для запуска контейнеров.

Это главный объект в кластере, в нём прописано какие контейнеры запускать, количество реплик, политика перезапуска,  
лимиты, подключаемые ресурсы.
___

**Namespace** - логически разграничивает и изолирует ресурсы между подами, позволяет разделять пользователей,  
применять разные политики квот и права доступа на проект.
___

## Helm

**Helm** - пакетный менеджер кубера; позволяет запускать, обновлять, откатывать приложение с помощью чартов.

**Chart** - коллекция связанных манифестов кубера.

Пример манифестов:

- `deployment.yaml` - ресурс типа Deployment; управляет подами, следит чтобы все реплики были развёрнуты.
- `ingress.yaml` - ресурс типа Ingress; для обеспечения доступа к сервису через https
- `service.yaml` - ресурс типа Service; обеспечивает доступ к запущенному сервису внутр кластера.

Helm структура:

- `charts/` - содержит сторонние чарты, от которых зависит текущий
- `Chart.yaml` - основные сведения о чарте
- `templates/` - шаблону кубера с возможностью форматирования и вставки значений helm
  - `*.tpl` - собственные именованные шаблоны
- `values.yaml` - содержит переменные используемые в шаблонах
___


